"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var path_1=__importDefault(require("path")),net_1=__importDefault(require("net")),http_1=__importDefault(require("http")),express_1=__importDefault(require("express")),compression_1=__importDefault(require("compression")),routes_1=__importDefault(require("./routes")),httpPort=8080,tcpPort=9833,app=(0,express_1.default)();app.locals.baseDir=path_1.default.join(__dirname,"../"),app.use(express_1.default.json()),app.use(express_1.default.urlencoded({extended:!0})),app.use((0,compression_1.default)()),app.use(express_1.default.static(path_1.default.join(__dirname,"../public"))),app.use(routes_1.default);var httpServer=http_1.default.createServer(app);httpServer.listen(httpPort,(function(){console.log("HTTP server listening on "+httpPort+" port")}));var tcpSever=net_1.default.createServer();tcpSever.listen(tcpPort,(function(){console.log("TCP server listening on "+tcpPort+" port")})),tcpSever.on("connection",(function(e){var t;process.env.PHONE_ADDRESS=null===(t=e.remoteAddress)||void 0===t?void 0:t.replace("::ffff:","")})),process.on("uncaughtException",(function(e){console.error(e.message),process.exit()})),process.on("unhandledRejection",(function(e,t){console.error("Unhandled Rejection at: "+t+" reason: "+e),process.exit()}));